<%- include('partials/header.html') %>

<link rel="stylesheet" href="/css/search.css">

<div class="card">
  <div class="card-header">
    <h1>Search</h1>
  </div>

  <div id="searchframe">

    <div v-if="scan" class="video-container">
      <button type="button" class="btn btn-secondary rounded-pill" v-on:click="resetScan">Abort</button>
      <video id="video"></video>
    </div>

    <!-- Input Modal -->
    <div class="modal fade" id="inputModal" tabindex="-1" aria-labelledby="inputModalLabel" aria-hidden="true">
      <div class="modal-dialog">
        <div class="modal-content">
          <div class="modal-header">
            <h5 class="modal-title" id="inputModalLabel">Input</h5>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close">
              <span aria-hidden="true">&times;</span>
            </button>
          </div>
          <div class="modal-body">
            <ul class="list-group list-group-flush">
              <li class="list-group-item" v-for="(ingredient, index) in ingredients">
                <div class="input-group mb-3">
                  <input type="text" class="form-control-plaintext" v-bind:value="ingredient" style="border-width:0px; border:none;" readonly></input>
                  <div class="input-group-append">
                    <button type="button" class="close" v-on:click="dropIngredient(index)">
                      <span aria-hidden="true">&times;</span>
                    </button>
                  </div>
                </div>
              </li>
              <li class="list-group-item">
                <div class="input-group mb-3">
                  <input type="text" id="input_ingredient" v-on:keyup="validateInput" class="form-control" style="border-width:0px; border:none;" placeholder="what's left?">
                  <div class="input-group-append">
                    <button class="btn btn-outline-primary rounded" v-on:click="startScan">
                      <svg width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-upc-scan" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                        <path fill-rule="evenodd" d="M1.5 1a.5.5 0 0 0-.5.5v3a.5.5 0 0 1-1 0v-3A1.5 1.5 0 0 1 1.5 0h3a.5.5 0 0 1 0 1h-3zM11 .5a.5.5 0 0 1 .5-.5h3A1.5 1.5 0 0 1 16 1.5v3a.5.5 0 0 1-1 0v-3a.5.5 0 0 0-.5-.5h-3a.5.5 0 0 1-.5-.5zM.5 11a.5.5 0 0 1 .5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 1 0 1h-3A1.5 1.5 0 0 1 0 14.5v-3a.5.5 0 0 1 .5-.5zm15 0a.5.5 0 0 1 .5.5v3a1.5 1.5 0 0 1-1.5 1.5h-3a.5.5 0 0 1 0-1h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 1 .5-.5z"/>
                        <path d="M3 4.5a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7zm2 0a.5.5 0 0 1 .5-.5h1a.5.5 0 0 1 .5.5v7a.5.5 0 0 1-.5.5h-1a.5.5 0 0 1-.5-.5v-7zm3 0a.5.5 0 0 1 1 0v7a.5.5 0 0 1-1 0v-7z"/>
                      </svg>
                    </button>
                  </div>
                </div>
              </li>
            </ul>
          </div>
          <div class="modal-footer">
            <button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
            <button type="button" class="btn btn-primary" v-on:click="findRecipes" data-dismiss="modal">Search for
              recipes</button>
          </div>
        </div>
      </div>
    </div>

    <ul class="list-group list-group-flush">
      <li class="list-group-item">
        <span class="badge badge-pill badge-secondary" v-for="ingredient in ingredients"><h6>${ingredient}</h6></span>
        <span class="badge badge-pill badge-primary" data-toggle="modal" data-target="#inputModal">
          <svg width="2em" height="2em" viewBox="0 0 16 16" class="bi bi-three-dots" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
            <path fill-rule="evenodd" d="M3 9.5a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3zm5 0a1.5 1.5 0 1 1 0-3 1.5 1.5 0 0 1 0 3z"/>
          </svg>
        </span>
      </li>
      <li v-for="recipe in recipes" class="list-group-item">
        <img v-bind:src="recipe.image" class="card-img-top d-inline" alt="...">
        <h5 class="card-title"><a v-bind:href="'/recipe?id='+ recipe.id">${recipe.title}</a></h5>
        <h5 class="card-title">2 of 5 ingredients used.</h5>
      </li>
    </ul>
  </div>
</div>

<%- include('partials/scripts.html') %>
<%- include('partials/bar.html') %>

<script>bar.page = 1</script>

<script>
  $('#inputModal').on('shown.bs.modal', function () {
  // get the locator for an input in your modal. Here I'm focusing on
  // the element with the id of myInput
  $('#input_ingredient').focus()
})
</script>

<script type="text/javascript" src="https://unpkg.com/@zxing/library@latest"></script>
<script src='/js/search.js' type='text/javascript'></script>

<%- include('partials/footer.html') %>